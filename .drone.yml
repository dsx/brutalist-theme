kind: pipeline
name: meta-data

steps:
  - name: dco
    image: algernon/drone-plugin-dco
    depends_on: [ clone ]

  - name: signature-check
    image: algernon/drone-plugin-signature-check
    depends_on: [ clone ]
    settings:
      keys: [ 10E65DC045EABEFCC5193A26AC1E90BAC433F68F ]
    when:
      event: tag

---
kind: pipeline
name: build

steps:
  - name: byte-compile
    image: registry.madhouse-project.org/algernon/drone-language:emacs
    pull: always
    depends_on: [ clone ]
    settings:
      byte_compile:
        - brutalist-theme.el
        - brutalist-dark-theme.el

  - name: checkdoc
    image: registry.madhouse-project.org/algernon/drone-language:emacs
    pull: always
    depends_on: [ clone ]
    settings:
      checkdoc:
        - brutalist-build.el
        - brutalist-theme.el
        - brutalist-dark-theme.el

  - name: lint
    image: registry.madhouse-project.org/algernon/drone-language:emacs
    pull: always
    depends_on: [ clone ]
    settings:
      lint:
        - brutalist-build.el
        - brutalist-theme.el
        - brutalist-dark-theme.el
      ignore_warnings:
        - package-prefix

image_pull_secrets:
  - registry_madhouse_project_org
